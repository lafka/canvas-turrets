<!DOCTYPE html>
<html>
	<head>
		<title>Canvas Turrets</title>
		
		<!-- FYI: jquery is no longer needed -->
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
		
		<script type="text/javascript" src="src/config.js"></script>
		<script type="text/javascript" src="src/game.js"></script>
		<script type="text/javascript" src="src/collision.js"></script>
		<script type="text/javascript" src="src/mountain.js"></script>
		
		<script type="text/javascript" src="src/wind.js"></script>
		
		<script type="text/javascript" src="src/turret.js"></script>
		<script type="text/javascript" src="src/bullet.js"></script>
		<script type="text/javascript">
		function bumpTheCloud(Game)
        {
/*		
            var dx = GameInstance.players[0].x - bullet.x;
            var dy = GameInstance.players[0].y - bullet.y;
            var dist = Math.sqrt(dx*dx + dy*dy)/2;
            //2 = bullet radius
            if (dist<2+50) {
                alert('Bang - You shot yourself');
                clearInterval(timer);
                GameInstance.timer=null;
            }
*/
			var turret;

			
			if ( Game.firedBy === 1 )
			{
				turret = 0;
			}else if ( Game.firedBy === 0 )
			{
				turret = 1;
			}else if ( Game.currentPlayer === -1 )
			{
				return;
			}
			else {
				return;
			}
			console.log(turret);
            var dx = Game.players[turret].x - Game.bullet.x;
            var dy = Game.players[turret].y - Game.bullet.y;

            var dist = Math.sqrt(dx*dx + dy*dy);

            //2 = bullet radius
            if (dist<2+50) {
                alert('Bang - Killer!');
                //clearInterval(timer);
                Game.currentPlayer = -1;
                Game.firedBy = -1;
                Game.timer=null;
            }
        }
		
			window.addEventListener('load', function() {
			    
			   var drawingCanvas    = document.getElementById('map');
			
  			   // Check the element is in the DOM and the browser supports canvas
  			   if (drawingCanvas.getContext) {
  			       var context = drawingCanvas.getContext('2d');
				    
				   // Create a new game
				   var game = new Game( context );
                   window.game = game;
				   
				   // Let's GO!
				   game.start();
				   
				   window.GameInstance = game;
				     			  
  			   }
  			   
	  			document.getElementById('restart').addEventListener('click',function(event){
	  				event.preventDefault(true);
	  				GameInstance.start();
	  			}, true);	 
			}, true);
			
			
		</script>
	</head>
	<body>
		<canvas id="map" width="1000" height="500" style="margin: 10px 0 0 0; ">
			Sorry, does not look like you have support for canvas.<br />
			I think there's a DOS version somewhere...............
		</canvas>
		<input id="setspeed" value="0" />
		<button id="restart">Restart</button>
	</body>
</html>